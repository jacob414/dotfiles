#!/usr/bin/env bash
set -euo pipefail

if [[ $# -ne 1 ]]; then
  echo "Usage: $(basename "$0") <image.HEIC>" >&2
  exit 1
fi

input=$1
if [[ ! -f $input ]]; then
  echo "Error: File not found: $input" >&2
  exit 1
fi

extension=${input##*.}
if [[ ! $extension =~ ^([Hh][Ee][Ii][Cc])$ ]]; then
  echo "Error: Input must have .HEIC extension" >&2
  exit 1
fi

output="${input%.*}.jpg"

magick "$input" "$output"
